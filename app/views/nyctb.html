
<style> 
.Manhattan {

	fill: #ddc;
}

.Queens {

	fill: #EDF7F7;
}

.Brooklyn {

	fill: #cdc;
}
.Bronx { fill: #fff;}
.bubble {
  fill-opacity: .5;
  stroke: #fff;
  stroke-width: .5px;
  fill: grey;
}
.bubble :hover{
	fill-opacity: 1;
	fill: brown;
}
.legend {
	fill: none;
	stroke: grey;
}
.legend text {
	font-size: 7px;
	text-anchor: middle;
}


</style>


<div class="panel panel-default">
  <div class="panel-body">
   <button type="button" class="btn btn-default" ng-click="fbackward()" ng-disabled="dt > 1800"><i class="fa fa-fast-backward"></i></button>
   <button type="button" class="btn btn-default" ng-click="letsStop()" ng-disabled="!playing"><i class="fa fa-pause"></i></button>
   <button type="button" class="btn btn-default" ng-click="letsRun(dt)" ng-disabled="playing"><i class="fa fa-play"></i></button>
   <button type="button" class="btn btn-default" ng-click="fforward()" ng-disabled="dt < 300"><i class="fa fa-fast-forward"></i></button>
   
   <h4> {{dt}} {{playing}} {{count}} </h4>

   <i class="fa fa-cog fa-3x pull-right fa-spin"></i>
  </div>
</div>
<nyct-bike data="nyb" id="nycbody"></nyct-bike>

<script>


// var width = 800,
//    height = 700;

// var radius = d3.scale.sqrt()
//     .domain([0, 60])
//     .range([0, 20]);

// var bwcolor = d3.scale.linear()
//     .domain([5, 9, 15, 18, 23])
//     .range(["grey", "white", "white", "grey", "black"]);

// var diffcolor = d3.scale.linear()
//     .domain([-7, 0, 7])
//     .range(["red", "grey", "green"]);

// var svg = d3.select("#nycbody").append("svg")
//     .attr("width", width)
//     .attr("height", height)
//     .attr("style", "background-color:white");

// d3.json("nyc.json", function(error, nyb) {

//     var projection = d3.geo.mercator()
//   					.center([-73.94, 40.70])
//   					.scale(290000)
//   					.translate([(width) / 2 + 150, (height)/2 + 120])
//   					.rotate([0.01, 0, 0.01]);

// 	var path = d3.geo.path()
// 			.projection(projection);

// 	var g = svg.append("g");


//     var legend = svg.append("g")
//     .attr("class", "legend")
//     .attr("transform", "translate(" + (width - 700) + "," + (height - 500) + ")")
//     .selectAll("g")
//     .data([5, 20, 50])
//     .enter().append("g");

// 	legend.append("circle")
// 	    .attr("cy", function(d) { return -radius(d) })
// 	    .attr("r", function(d) {  return radius(d)    });

// 	legend.append("text")
// 	    .attr("y", function(d) { return -2 * radius(d); })
// 	    .attr("dy", "1em")
// 	    .text(d3.format(".1s"));

// 	var datetime = svg.append("g")
//     .attr("class", "datetime")
//     .attr("transform", "translate(" + (width - 700) + "," + (height - 750) + ")")
//     .selectAll("g")
//     .data(["Datetime"])
//     .enter().append("g");

//     datetime.append("text")
// 	.attr("dy", "5em")
// 	.text("Datetime");
 



// 	g.append("g")
// 		.attr("id", "boroughs")
// 		.selectAll(".state")
// 		.data(nyb.objects.boros.features)
// 		.enter().append("path")
// 		.attr("class", function(d){ return d.properties.borough; })
// 		.attr("d", path);

// 	svg.append("g")
//     .attr("class", "bubble")
//   	.selectAll("circle")
//     .data(topojson.feature(nyb, nyb.objects.stations).features)
//   	.enter().append("circle")
//   	.attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })
//   	.attr("id", function(d){ return "Station_"+d.properties.Station_Id; })
//   	.attr("class", "bubbles")
//     .attr("r", 5)
//     .append("svg:title")
//     .text(function(d) { return d.properties.Address; });

	

// 	  var circle_order = [];
// 	  var circles = d3.selectAll("circle.bubbles");
// 	  circles[0].forEach(function(e,i,array){
// 	  	 circle_order.push(e.id.split("_")[1]);
// 	  	 	// if (e.id.split("_")[1] == 289){console.log(i)};
// 	  });
	  

// 	  function data_scrambler(firebase_array1, firebase_array2, order){
//          var newarray1 = [];  
//          var newarray2 = [];
//          var newarray3 = [];   
//          var newarray4 = [];
//          var timestamp = firebase_array1[firebase_array1.length-1].substring(0,16);
//          order.forEach(function(e,i,a){
//          	newarray1.push(firebase_array1[e])
//          });
//          if (firebase_array2){
//          	firebase_array1.slice(1,firebase_array1.length-1).forEach(function(e,i,a){
//          		newarray2.push(firebase_array1[i+1]-firebase_array2[i+1])
//          	});
//          }else{
//          	firebase_array1.slice(1,firebase_array1.length-1).forEach(function(e,i,a){
//          	    newarray2.push(0);                     });
//          }; 
//          order.forEach(function(e,i,a){
//          	newarray4.push(newarray2[e-1])
//          });
//          newarray1.forEach(function(e,i,a){
//          	newarray3.push({number: e, differential: newarray4[i]})
//          });
//          return { data: newarray3, time: timestamp, hour: timestamp.substring(11,13)}
// 	  };
//       var dt = 500;

// 	  var ref = new Firebase('https://luminous-fire-6005.firebaseio.com/Citibike');
// 	  var reflimit = ref.limit(1000);
//       reflimit.on('value', function (snapshot) {
//   	              fb_json = (snapshot.val()); 
//   	              fb_array = [];
//   	           for (var k in fb_json){
//   	           	fb_array.push(fb_json[k]) };
//   	           	// for (a in fb_array){
//   	           	// console.log(fb_array[a].length)      }
//   	           	var count=10;
//   	           setInterval(function(){         
//   	           circle_data = data_scrambler(fb_array[count], fb_array[count-1], circle_order);
//   	           console.log([circle_data.data[322].differential,circle_data.data[322].number]);
//   	           circles.data(circle_data.data);
//   	           circles.transition(dt).attr("r", function(d) { return radius(d.number)} ); 
//   	            circles.attr("style", function(d) {return "fill:" + diffcolor(d.differential)} ); 
//   	           svg.attr("style", "background-color:"+ bwcolor(circle_data.hour));
//   	           d3.selectAll("g.datetime text").text(circle_data.time);  
//   	           if (count == 999){ count = 0}else{ count += 1};
//   	           }, dt);

//   	       });

      

//      });



</script>
